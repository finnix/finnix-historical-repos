#!/usr/bin/make -f
# -*- makefile -*-

# Uncomment this to turn on verbose mode.
#export DH_VERBOSE=1

%:
	dh $@

override_dh_auto_install:
	# Copy the root directory into place
	install -m 0755 -d $(CURDIR)/debian/finnix-scripts
	cp -a root/* $(CURDIR)/debian/finnix-scripts

	# Fonts
	install -m 0755 -d $(CURDIR)/debian/finnix-scripts/usr/share/consolefonts
	gzip -c <Fonts/Lat2-VGA8.psf >$(CURDIR)/debian/finnix-scripts/usr/share/consolefonts/finnix8x8.psf.gz
	gzip -c <Fonts/Lat2-VGA16.psf >$(CURDIR)/debian/finnix-scripts/usr/share/consolefonts/finnix8x16.psf.gz

	# Documentation
	install -m 0755 -d $(CURDIR)/debian/finnix-scripts/usr/share/man/man1
	pod2man -c '' -r '' -s 1 man/shell-login.pod >$(CURDIR)/debian/finnix-scripts/usr/share/man/man1/shell-login.1
	pod2man -c '' -r '' -s 1 man/rebuildfstab.pod >$(CURDIR)/debian/finnix-scripts/usr/share/man/man1/rebuildfstab.1
	pod2man -c '' -r '' -s 1 man/cnf-finnix.pod >$(CURDIR)/debian/finnix-scripts/usr/share/man/man1/cnf-finnix.1
	pod2man -c '' -r '' -s 1 man/finnix-chroot-dev.pod >$(CURDIR)/debian/finnix-scripts/usr/share/man/man1/finnix-chroot-dev.1
	pod2man -c '' -r '' -s 1 man/finnix-strace-reorder.pod >$(CURDIR)/debian/finnix-scripts/usr/share/man/man1/finnix-strace-reorder.1
	pod2man -c '' -r '' -s 1 man/finnix-hwsubmit.pod >$(CURDIR)/debian/finnix-scripts/usr/share/man/man1/finnix-hwsubmit.1
	pod2man -c '' -r '' -s 1 man/finnix-build-stage1.pod >$(CURDIR)/debian/finnix-scripts/usr/share/man/man1/finnix-build-stage1.1
	pod2man -c '' -r '' -s 1 man/finnix-build-stage2.pod >$(CURDIR)/debian/finnix-scripts/usr/share/man/man1/finnix-build-stage2.1
	pod2man -c '' -r '' -s 1 man/finnix-generate-entropy.pod >$(CURDIR)/debian/finnix-scripts/usr/share/man/man1/finnix-generate-entropy.1
	pod2man -c '' -r '' -s 1 man/finnix-pretty-cpu.pod >$(CURDIR)/debian/finnix-scripts/usr/share/man/man1/finnix-pretty-cpu.1
	pod2man -c '' -r '' -s 1 man/finnix-strace-init.pod >$(CURDIR)/debian/finnix-scripts/usr/share/man/man1/finnix-strace-init.1
	pod2man -c '' -r '' -s 1 man/finnix-keyboard-choose.pod >$(CURDIR)/debian/finnix-scripts/usr/share/man/man1/finnix-keyboard-choose.1
	pod2man -c '' -r '' -s 1 man/zram_stat.pod >$(CURDIR)/debian/finnix-scripts/usr/share/man/man1/zram_stat.1

override_dh_md5sums:
	dh_md5sums -x

override_dh_builddeb:
	dh_builddeb -- -Zxz
